{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/stco/personal/nextjs-maxmiller/meals-app/lib/meals.js"],"sourcesContent":["import sql from 'better-sqlite3';\nimport slugify from 'slugify';\nimport xss from 'xss';\nimport fs from 'fs';\n\nconst db = sql('meals.db');\n\n\n\nexport async function getMeals() {\n    await new Promise(resolve => setTimeout(resolve, 5000));\n    // throw new Error('Something went wrong');\n    return db.prepare('SELECT * FROM meals').all();\n}\n\nexport function getMealById(id) {\n    return db.prepare('SELECT * FROM meals WHERE slug = ?').get(id);\n}\n\nexport async function saveMeal(meal) {\n    meal.slug = slugify(meal.title, { lower: true });\n    meal.instructions = xss(meal.instructions);\n\n\n    const extension = meal.image.name.split('.').pop();\n    const filename = meal.slug + \".\" + extension;\n    const path = \"public/images/\" + filename;\n    const file = fs.createWriteStream(path);\n    const bufferedImage = await meal.image.arrayBuffer();\n    file.write(Buffer.from(bufferedImage));\n    file.end();\n    meal.image = \"/images/\" + filename;\n\n\n    const insert = db.prepare('INSERT INTO meals (slug, title, summary, instructions, creator, creator_email, image) VALUES (?, ?, ?, ?, ?, ?, ?)');\n    insert.run(meal.slug,\n        meal.title,\n        meal.summary,\n        meal.instructions,\n        meal.creator,\n        meal.creatorEmail,\n        meal.image);\n}"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,KAAK,IAAA,sIAAG,EAAC;AAIR,eAAe;IAClB,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;IACjD,2CAA2C;IAC3C,OAAO,GAAG,OAAO,CAAC,uBAAuB,GAAG;AAChD;AAEO,SAAS,YAAY,EAAE;IAC1B,OAAO,GAAG,OAAO,CAAC,sCAAsC,GAAG,CAAC;AAChE;AAEO,eAAe,SAAS,IAAI;IAC/B,KAAK,IAAI,GAAG,IAAA,6IAAO,EAAC,KAAK,KAAK,EAAE;QAAE,OAAO;IAAK;IAC9C,KAAK,YAAY,GAAG,IAAA,8IAAG,EAAC,KAAK,YAAY;IAGzC,MAAM,YAAY,KAAK,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG;IAChD,MAAM,WAAW,KAAK,IAAI,GAAG,MAAM;IACnC,MAAM,OAAO,mBAAmB;IAChC,MAAM,OAAO,wGAAE,CAAC,iBAAiB,CAAC;IAClC,MAAM,gBAAgB,MAAM,KAAK,KAAK,CAAC,WAAW;IAClD,KAAK,KAAK,CAAC,OAAO,IAAI,CAAC;IACvB,KAAK,GAAG;IACR,KAAK,KAAK,GAAG,aAAa;IAG1B,MAAM,SAAS,GAAG,OAAO,CAAC;IAC1B,OAAO,GAAG,CAAC,KAAK,IAAI,EAChB,KAAK,KAAK,EACV,KAAK,OAAO,EACZ,KAAK,YAAY,EACjB,KAAK,OAAO,EACZ,KAAK,YAAY,EACjB,KAAK,KAAK;AAClB"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/stco/personal/nextjs-maxmiller/meals-app/lib/actions.js"],"sourcesContent":["'use server'\n\nimport { redirect } from \"next/navigation\"\nimport { saveMeal } from \"./meals\"\n\nfunction isInvalidText(text) {\n    return text.trim === \"\" || !text\n}\n\n//this is like any function over here will be server action.\nexport async function shareMeal(prevData, formData) {\n    // this i have used bcs we are using 'use client' in the form, this created a server action only execute on the server not on the client\n    // 'use server'\n\n    const meal = {\n        title: formData.get('title'),\n        summary: formData.get('summary'),\n        instructions: formData.get('instructions'),\n        creator: formData.get('name'),\n        creatorEmail: formData.get('email'),\n        image: formData.get('image')\n    }\n\n    if (isInvalidText(meal.title) || isInvalidText(meal.summary) || isInvalidText(meal.instructions) || isInvalidText(meal.creator) || isInvalidText(meal.creatorEmail) || !meal.image || meal.image.size === 0) {\n\n        return {\n            error: 'All fields are required'\n        }\n    }\n\n    await saveMeal(meal)\n    redirect(\"/meals\")\n}"],"names":[],"mappings":";;;;;;AAEA;AAAA;AACA;;;;;;AAEA,SAAS,cAAc,IAAI;IACvB,OAAO,KAAK,IAAI,KAAK,MAAM,CAAC;AAChC;AAGO,eAAe,UAAU,QAAQ,EAAE,QAAQ;IAC9C,wIAAwI;IACxI,eAAe;IAEf,MAAM,OAAO;QACT,OAAO,SAAS,GAAG,CAAC;QACpB,SAAS,SAAS,GAAG,CAAC;QACtB,cAAc,SAAS,GAAG,CAAC;QAC3B,SAAS,SAAS,GAAG,CAAC;QACtB,cAAc,SAAS,GAAG,CAAC;QAC3B,OAAO,SAAS,GAAG,CAAC;IACxB;IAEA,IAAI,cAAc,KAAK,KAAK,KAAK,cAAc,KAAK,OAAO,KAAK,cAAc,KAAK,YAAY,KAAK,cAAc,KAAK,OAAO,KAAK,cAAc,KAAK,YAAY,KAAK,CAAC,KAAK,KAAK,IAAI,KAAK,KAAK,CAAC,IAAI,KAAK,GAAG;QAEzM,OAAO;YACH,OAAO;QACX;IACJ;IAEA,MAAM,IAAA,wHAAQ,EAAC;IACf,IAAA,iMAAQ,EAAC;AACb;;;IAtBsB;;AAAA,+OAAA"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Users/stco/personal/nextjs-maxmiller/meals-app/.next-internal/server/app/meals/share/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {shareMeal as '607a708f598a5dd1ec60aeb735de54ac4fc038044e'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}